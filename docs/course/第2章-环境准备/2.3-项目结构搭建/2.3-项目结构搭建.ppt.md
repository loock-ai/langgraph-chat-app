---
marp: true
theme: gaia
paginate: true
header: '2.3-é¡¹ç›®ç»“æ„æ­å»º'
style: |
  section {
    font-size: 30px;
  }
---

<!-- _class: lead -->
# 2.3 é¡¹ç›®ç»“æ„æ­å»º ğŸ“

## æ„å»ºæ¸…æ™°å¯ç»´æŠ¤çš„é¡¹ç›®æ¶æ„

**LangGraphæ™ºèƒ½èŠå¤©åº”ç”¨å¼€å‘æ•™ç¨‹**

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡æ¦‚è¿°

### æœ¬èŠ‚è¯¾çš„æ ¸å¿ƒä»·å€¼
- **ğŸ—ï¸ æŒæ¡é¡¹ç›®æ¶æ„è®¾è®¡**ï¼šå­¦ä¼šç»„ç»‡å¤æ‚é¡¹ç›®çš„æ–‡ä»¶ç»“æ„
- **ğŸ“‹ å»ºç«‹å¼€å‘è§„èŒƒ**ï¼šç»Ÿä¸€å›¢é˜Ÿçš„é¡¹ç›®ç»„ç»‡æ–¹å¼
- **âš¡ æå‡å¼€å‘æ•ˆç‡**ï¼šæ¸…æ™°çš„ç»“æ„å‡å°‘å¼€å‘æ—¶é—´

### å…·ä½“å­¦ä¹ ç›®æ ‡
- ç†è§£Next.jsé¡¹ç›®çš„æ ‡å‡†ç»“æ„
- æŒæ¡pnpmå·¥ä½œåŒºçš„é…ç½®
- å­¦ä¼šé…ç½®TypeScriptå’ŒESLint
- äº†è§£é¡¹ç›®é…ç½®æ–‡ä»¶çš„ä½œç”¨

---

## ğŸ—ï¸ é¡¹ç›®ç»“æ„æ€»è§ˆ

### å®Œæ•´é¡¹ç›®æ¶æ„
```
langgraph-chat-app/
â”œâ”€â”€ ğŸ“± app/                  # Next.jsåº”ç”¨ç›®å½•
â”œâ”€â”€ ğŸ“š docs/                 # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ ğŸ”§ config/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“¦ package.json          # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ ğŸŒ pnpm-workspace.yaml   # å·¥ä½œåŒºé…ç½®
â”œâ”€â”€ ğŸ“ tsconfig.json         # TypeScripté…ç½®
â”œâ”€â”€ ğŸ” eslint.config.mjs     # ä»£ç è§„èŒƒé…ç½®
â””â”€â”€ ğŸ“‹ README.md             # é¡¹ç›®è¯´æ˜
```

æ¯ä¸ªç›®å½•éƒ½æœ‰æ˜ç¡®çš„èŒè´£å’Œç”¨é€”ã€‚

---

## ğŸš€ åˆ›å»ºé¡¹ç›®éª¨æ¶

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®ç›®å½•
```bash
# åˆ›å»ºé¡¹ç›®æ ¹ç›®å½•
mkdir langgraph-chat-app
cd langgraph-chat-app

# åˆå§‹åŒ–Gitä»“åº“
git init
git branch -M main

# åˆ›å»ºåŸºæœ¬ç›®å½•ç»“æ„
mkdir app docs config
mkdir app/{api,components,utils}
mkdir app/api/{chat,sessions}
mkdir docs/course
```

### ç¬¬äºŒæ­¥ï¼šåˆå§‹åŒ–pnpmé¡¹ç›®
```bash
# åˆå§‹åŒ–package.json
pnpm init

# è®¾ç½®å·¥ä½œåŒº
echo 'packages:
  - "app"
  - "docs"' > pnpm-workspace.yaml
```

---

## ğŸ“± Appç›®å½•ç»“æ„

### Next.js App Routerç»“æ„
```
app/
â”œâ”€â”€ ğŸ”— api/                  # APIè·¯ç”±
â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”œâ”€â”€ route.ts         # èŠå¤©API
â”‚   â”‚   â””â”€â”€ sessions/
â”‚   â”‚       â””â”€â”€ route.ts     # ä¼šè¯ç®¡ç†API
â”œâ”€â”€ ğŸ§© components/           # Reactç»„ä»¶
â”‚   â”œâ”€â”€ SessionSidebar.tsx   # ä¼šè¯ä¾§è¾¹æ 
â”‚   â”œâ”€â”€ ChatMessage.tsx      # æ¶ˆæ¯ç»„ä»¶
â”‚   â””â”€â”€ MessageInput.tsx     # è¾“å…¥ç»„ä»¶
â”œâ”€â”€ ğŸ› ï¸ utils/                # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ loadEnv.ts          # ç¯å¢ƒå˜é‡åŠ è½½
â”‚   â””â”€â”€ threadId.ts         # çº¿ç¨‹IDç”Ÿæˆ
â”œâ”€â”€ ğŸ¤– agent/                # AIä»£ç†
â”‚   â”œâ”€â”€ chatbot.ts          # èŠå¤©æœºå™¨äºº
â”‚   â”œâ”€â”€ tools.ts            # AIå·¥å…·
â”‚   â”œâ”€â”€ db.ts               # æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ config/             # ä»£ç†é…ç½®
â”œâ”€â”€ ğŸ“„ page.tsx              # ä¸»é¡µé¢
â”œâ”€â”€ ğŸ¨ layout.tsx            # å¸ƒå±€ç»„ä»¶
â”œâ”€â”€ ğŸŒ globals.css           # å…¨å±€æ ·å¼
â””â”€â”€ ğŸ”– favicon.ico           # ç«™ç‚¹å›¾æ ‡
```

---

## ğŸ“š æ–‡æ¡£ç›®å½•ç»“æ„

### è¯¾ç¨‹æ–‡æ¡£ç»„ç»‡
```
docs/
â”œâ”€â”€ ğŸ“– course/               # è¯¾ç¨‹å†…å®¹
â”‚   â”œâ”€â”€ ğŸ“‹ course-outline.md # è¯¾ç¨‹å¤§çº²
â”‚   â”œâ”€â”€ ğŸ“‚ ç¬¬1ç« -æ¦‚å¿µå…¥é—¨/
â”‚   â”‚   â”œâ”€â”€ 1.1-AIåº”ç”¨å¼€å‘åŸºç¡€/
â”‚   â”‚   â”œâ”€â”€ 1.2-é¡¹ç›®æŠ€æœ¯æ ˆåº”ç”¨/
â”‚   â”‚   â””â”€â”€ 1.3-é¡¹ç›®æ¶æ„è®¾è®¡/
â”‚   â”œâ”€â”€ ğŸ“‚ ç¬¬2ç« -ç¯å¢ƒå‡†å¤‡/
â”‚   â”‚   â”œâ”€â”€ 2.1-å¼€å‘å·¥å…·å®‰è£…/
â”‚   â”‚   â”œâ”€â”€ 2.3-é¡¹ç›®ç»“æ„æ­å»º/
â”‚   â”‚   â””â”€â”€ 2.4-ç¯å¢ƒå˜é‡é…ç½®/
â”‚   â””â”€â”€ ğŸ“‚ ç¬¬3ç« -å‰ç«¯åŸºç¡€/
â”‚       â”œâ”€â”€ 3.1-ReactåŸºç¡€åº”ç”¨/
â”‚       â”œâ”€â”€ 3.2-Next.jsé¡¹ç›®åº”ç”¨/
â”‚       â””â”€â”€ 3.3-TypeScriptå®é™…åº”ç”¨/
â”œâ”€â”€ ğŸ“ README.md             # æ–‡æ¡£è¯´æ˜
â””â”€â”€ ğŸ¬ recording-script.md   # å½•åˆ¶è„šæœ¬
```

---

## ğŸ“¦ Package.json é…ç½®

### é¡¹ç›®ä¾èµ–é…ç½®
```json
{
  "name": "langgraph-chat-app",
  "version": "1.0.0",
  "description": "AIèŠå¤©åº”ç”¨å¼€å‘æ•™ç¨‹é¡¹ç›®",
  "private": true,
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "type-check": "tsc --noEmit"
  },
  "dependencies": {
    "next": "^15.0.0",
    "react": "^18.0.0",
    "react-dom": "^18.0.0",
    "@langchain/langgraph": "^0.0.34",
    "@langchain/openai": "^0.3.0"
  },
  "devDependencies": {
    "typescript": "^5.0.0",
    "@types/react": "^18.0.0",
    "@types/node": "^20.0.0",
    "eslint": "^8.0.0",
    "eslint-config-next": "^15.0.0",
    "tailwindcss": "^3.0.0",
    "autoprefixer": "^10.0.0",
    "postcss": "^8.0.0"
  }
}
```

### è„šæœ¬å‘½ä»¤è¯´æ˜
- **dev**ï¼šå¯åŠ¨å¼€å‘æœåŠ¡å™¨
- **build**ï¼šæ„å»ºç”Ÿäº§ç‰ˆæœ¬
- **start**ï¼šå¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
- **lint**ï¼šæ£€æŸ¥ä»£ç è§„èŒƒ
- **type-check**ï¼šTypeScriptç±»å‹æ£€æŸ¥

---

## ğŸŒ pnpmå·¥ä½œåŒºé…ç½®

### pnpm-workspace.yaml
```yaml
# pnpmå·¥ä½œåŒºé…ç½®
packages:
  # ä¸»åº”ç”¨
  - 'app'
  # æ–‡æ¡£é¡¹ç›®  
  - 'docs'
  # å…±äº«åŒ…
  - 'packages/*'
  # ç¤ºä¾‹é¡¹ç›®
  - 'examples/*'

# æ’é™¤æ¨¡å¼
exclude:
  - '**/node_modules/**'
  - '**/dist/**'
  - '**/.next/**'
```

### å·¥ä½œåŒºä¼˜åŠ¿
- **ğŸ“¦ ä¾èµ–å…±äº«**ï¼šç›¸åŒä¾èµ–åªå®‰è£…ä¸€æ¬¡
- **ğŸ”— å†…éƒ¨é“¾æ¥**ï¼šåŒ…ä¹‹é—´å¯ä»¥ç›¸äº’å¼•ç”¨
- **âš¡ æ„å»ºæ•ˆç‡**ï¼šæ‰¹é‡æ“ä½œæå‡æ•ˆç‡
- **ğŸ¯ ç‰ˆæœ¬ç»Ÿä¸€**ï¼šç¡®ä¿ä¾èµ–ç‰ˆæœ¬ä¸€è‡´æ€§

---

## ğŸ“ TypeScripté…ç½®

### tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["dom", "dom.iterable", "ES6"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./app/*"],
      "@/components/*": ["./app/components/*"],
      "@/utils/*": ["./app/utils/*"],
      "@/agent/*": ["./app/agent/*"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}
```

---

## ğŸ” ESLinté…ç½®

### eslint.config.mjs
```javascript
import { dirname } from "path";
import { fileURLToPath } from "url";
import { FlatCompat } from "@eslint/eslintrc";

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

const compat = new FlatCompat({
  baseDirectory: __dirname,
});

const eslintConfig = [
  ...compat.extends("next/core-web-vitals", "next/typescript"),
  {
    rules: {
      // è‡ªå®šä¹‰è§„åˆ™
      "@typescript-eslint/no-unused-vars": "error",
      "@typescript-eslint/no-explicit-any": "warn",
      "react-hooks/exhaustive-deps": "warn"
    }
  }
];

export default eslintConfig;
```

### ä»£ç è§„èŒƒçº¦å®š
- **ğŸ”’ ä¸¥æ ¼æ¨¡å¼**ï¼šå¯ç”¨TypeScriptä¸¥æ ¼æ£€æŸ¥
- **âš ï¸ è­¦å‘Šå¤„ç†**ï¼šæœªä½¿ç”¨å˜é‡å’Œanyç±»å‹è­¦å‘Š
- **ğŸ¯ Reactè§„èŒƒ**ï¼šéµå¾ªReact Hooksæœ€ä½³å®è·µ

---

## ğŸ¨ TailwindCSSé…ç½®

### tailwind.config.ts
```typescript
import type { Config } from "tailwindcss";

const config: Config = {
  content: [
    "./pages/**/*.{js,ts,jsx,tsx,mdx}",
    "./components/**/*.{js,ts,jsx,tsx,mdx}",
    "./app/**/*.{js,ts,jsx,tsx,mdx}",
  ],
  theme: {
    extend: {
      colors: {
        // è‡ªå®šä¹‰é¢œè‰²
        'chat-user': '#007bff',
        'chat-assistant': '#6c757d',
        'chat-bg': '#f8f9fa'
      },
      fontFamily: {
        // è‡ªå®šä¹‰å­—ä½“
        'mono': ['JetBrains Mono', 'monospace'],
      }
    },
  },
  plugins: [
    // æ·»åŠ å¸¸ç”¨æ’ä»¶
    require('@tailwindcss/typography'),
    require('@tailwindcss/forms'),
  ],
};

export default config;
```

### PostCSSé…ç½®
```javascript
// postcss.config.mjs
const config = {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
};

export default config;
```

---

## ğŸ”§ Next.jsé…ç½®

### next.config.ts
```typescript
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  // å®éªŒæ€§åŠŸèƒ½
  experimental: {
    // å¯ç”¨App Router
    appDir: true,
    // æœåŠ¡å™¨ç»„ä»¶
    serverComponentsExternalPackages: ['@langchain/langgraph']
  },
  
  // ç¯å¢ƒå˜é‡
  env: {
    CUSTOM_KEY: process.env.CUSTOM_KEY,
  },
  
  // é‡å®šå‘é…ç½®
  async redirects() {
    return [
      {
        source: '/home',
        destination: '/',
        permanent: true,
      },
    ];
  },
  
  // Webpacké…ç½®
  webpack: (config, { buildId, dev, isServer, defaultLoaders, webpack }) => {
    // è‡ªå®šä¹‰webpacké…ç½®
    return config;
  },
};

export default nextConfig;
```

---

## ğŸ“‹ é¡¹ç›®åˆå§‹åŒ–è„šæœ¬

### setup.shï¼ˆè‡ªåŠ¨åŒ–è„šæœ¬ï¼‰
```bash
#!/bin/bash
echo "ğŸš€ åˆå§‹åŒ–LangGraphèŠå¤©åº”ç”¨é¡¹ç›®..."

# åˆ›å»ºç›®å½•ç»“æ„
echo "ğŸ“ åˆ›å»ºé¡¹ç›®ç›®å½•..."
mkdir -p app/{api/{chat,sessions},components,utils,agent/{config}}
mkdir -p docs/course
mkdir -p config

# åˆå§‹åŒ–é¡¹ç›®
echo "ğŸ“¦ åˆå§‹åŒ–é¡¹ç›®é…ç½®..."
pnpm init

# å®‰è£…ä¾èµ–
echo "â¬‡ï¸ å®‰è£…é¡¹ç›®ä¾èµ–..."
pnpm add next react react-dom @langchain/langgraph @langchain/openai
pnpm add -D typescript @types/react @types/node eslint eslint-config-next tailwindcss autoprefixer postcss

# åˆå§‹åŒ–é…ç½®æ–‡ä»¶
echo "âš™ï¸ åˆ›å»ºé…ç½®æ–‡ä»¶..."
npx tailwindcss init -p --ts

# åˆ›å»ºåŸºæœ¬æ–‡ä»¶
echo "ğŸ“ åˆ›å»ºåŸºç¡€æ–‡ä»¶..."
touch app/{page.tsx,layout.tsx,globals.css}
touch app/api/chat/route.ts
touch app/components/SessionSidebar.tsx

echo "âœ… é¡¹ç›®åˆå§‹åŒ–å®Œæˆï¼"
echo "ğŸ¯ ä¸‹ä¸€æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡"
```

---

## ğŸ” é¡¹ç›®ç»“æ„éªŒè¯

### æ£€æŸ¥æ¸…å•
```bash
# éªŒè¯ç›®å½•ç»“æ„
tree -I 'node_modules|.next|dist' langgraph-chat-app/

# éªŒè¯é…ç½®æ–‡ä»¶
ls -la *.json *.yaml *.mjs *.ts

# éªŒè¯ä¾èµ–å®‰è£…
pnpm list

# éªŒè¯TypeScripté…ç½®
pnpm type-check

# éªŒè¯ä»£ç è§„èŒƒ
pnpm lint
```

### æˆåŠŸæ ‡å‡†
- âœ… ç›®å½•ç»“æ„æ¸…æ™°å®Œæ•´
- âœ… é…ç½®æ–‡ä»¶æ­£ç¡®æ— è¯¯
- âœ… ä¾èµ–å®‰è£…æˆåŠŸ
- âœ… TypeScriptç¼–è¯‘é€šè¿‡
- âœ… ESLintæ£€æŸ¥é€šè¿‡

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### æ–‡ä»¶å‘½åè§„èŒƒ
```
ğŸ“ ç›®å½•åï¼škebab-case (çŸ­æ¨ªçº¿å‘½å)
ğŸ“„ ç»„ä»¶æ–‡ä»¶ï¼šPascalCase.tsx
ğŸ“„ å·¥å…·æ–‡ä»¶ï¼šcamelCase.ts
ğŸ“„ é…ç½®æ–‡ä»¶ï¼škebab-case.config.ts
ğŸ“„ ç±»å‹æ–‡ä»¶ï¼štypes.ts
```

### ç›®å½•ç»„ç»‡åŸåˆ™
- **ğŸ¯ åŠŸèƒ½ä¼˜å…ˆ**ï¼šæŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ä»£ç 
- **ğŸ“± å±‚æ¬¡æ¸…æ™°**ï¼šUIã€é€»è¾‘ã€æ•°æ®åˆ†å±‚
- **ğŸ”„ å¯æ‰©å±•æ€§**ï¼šä¸ºæœªæ¥åŠŸèƒ½é¢„ç•™ç©ºé—´
- **ğŸ“‹ ä¸€è‡´æ€§**ï¼šä¿æŒå‘½åå’Œç»“æ„ä¸€è‡´

### ä»£ç ç»„ç»‡å»ºè®®
- **ğŸ”— ç›¸å…³æ€§**ï¼šç›¸å…³æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•
- **ğŸ“ ç²’åº¦æ§åˆ¶**ï¼šé¿å…ç›®å½•è¿‡æ·±æˆ–æ–‡ä»¶è¿‡å¤§
- **ğŸ·ï¸ æ˜ç¡®æ ‡è¯†**ï¼šæ–‡ä»¶åæ¸…æ¥šè¡¨è¾¾ç”¨é€”

---

<!-- _class: lead -->
# ğŸ‰ é¡¹ç›®ç»“æ„æ­å»ºå®Œæˆï¼

## ç°åœ¨æœ‰äº†æ¸…æ™°çš„é¡¹ç›®æ¶æ„

**ä¸‹ä¸€èŠ‚ï¼šç¯å¢ƒå˜é‡é…ç½®**
