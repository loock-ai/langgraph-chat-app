---
marp: true
theme: gaia
paginate: true
header: '5.1-OpenAI APIå®é™…åº”ç”¨'
style: |
  section {
    font-size: 30px;
  }
---

<!-- _class: lead -->
# ç¬¬5ç«  AIé›†æˆ ğŸ¤–

## 5.1 OpenAI APIå®é™…åº”ç”¨

**LangGraphæ™ºèƒ½èŠå¤©åº”ç”¨å¼€å‘æ•™ç¨‹**

---

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- **æ·±å…¥ç†è§£OpenAI APIçš„ä½¿ç”¨æ–¹æ³•**
- **æŒæ¡æ¨¡å‹é…ç½®å’Œå‚æ•°è°ƒä¼˜æŠ€å·§**
- **å­¦ä¼šæ¶ˆæ¯æ ¼å¼å¤„ç†å’Œä¸Šä¸‹æ–‡ç®¡ç†**
- **å®ç°åŸºç¡€çš„AIå¯¹è¯åŠŸèƒ½**

å¼€å¯AIåº”ç”¨å¼€å‘çš„æ ¸å¿ƒæŠ€èƒ½ï¼

---

## ğŸ“š OpenAI APIåŸºç¡€é…ç½®

### APIå¯†é’¥é…ç½®
```typescript
// ç¯å¢ƒå˜é‡é…ç½®
OPENAI_API_KEY=your_api_key_here
OPENAI_MODEL_NAME=qwen-plus  // æ¨èä½¿ç”¨qwen-plus

// ä»£ç ä¸­çš„é…ç½®
const model = new ChatOpenAI({
  openAIApiKey: process.env.OPENAI_API_KEY,
  modelName: process.env.OPENAI_MODEL_NAME || "qwen-plus"
});
```

å®‰å…¨çš„APIå¯†é’¥ç®¡ç†æ˜¯AIåº”ç”¨çš„åŸºç¡€ï¼

---

## ğŸ—ï¸ æ¨¡å‹é€‰æ‹©å’Œå‚æ•°è°ƒä¼˜

### qwen-plusæ¨¡å‹ä¼˜åŠ¿
- **ä¸­æ–‡å¯¹è¯èƒ½åŠ›å¼º** - ä¸“é—¨ä¼˜åŒ–çš„ä¸­æ–‡å¤§æ¨¡å‹
- **æ€§ä»·æ¯”é«˜** - æˆæœ¬æ§åˆ¶ä¸æ€§èƒ½çš„æœ€ä½³å¹³è¡¡
- **å“åº”é€Ÿåº¦å¿«** - é€‚åˆå®æ—¶èŠå¤©åº”ç”¨

### æ ¸å¿ƒå‚æ•°è§£æ
```typescript
const model = new ChatOpenAI({
  model: "qwen-plus",
  temperature: 0.7,        // åˆ›é€ æ€§æ§åˆ¶(0-2)
  maxTokens: 2000,         // æœ€å¤§è¾“å‡ºé•¿åº¦
  streaming: true,         // å¯ç”¨æµå¼å“åº”
});
```

---

## ğŸ’¡ æ¶ˆæ¯æ ¼å¼å’Œä¸Šä¸‹æ–‡ç®¡ç†

### LangChainæ¶ˆæ¯ç±»å‹
```typescript
import { SystemMessage, HumanMessage, AIMessage } from '@langchain/core/messages';

// ç³»ç»Ÿæ¶ˆæ¯ - è®¾ç½®AIè§’è‰²
const systemMsg = new SystemMessage("ä½ æ˜¯ä¸€ä¸ªå‹å¥½çš„AIåŠ©æ‰‹");

// ç”¨æˆ·æ¶ˆæ¯
const userMsg = new HumanMessage("ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±");

// AIå›å¤æ¶ˆæ¯
const aiMsg = new AIMessage("ä½ å¥½ï¼æˆ‘æ˜¯ä¸€ä¸ªAIåŠ©æ‰‹...");
```

æ ‡å‡†åŒ–çš„æ¶ˆæ¯æ ¼å¼è®©å¯¹è¯ç®¡ç†æ›´ç®€å•ï¼

---

## ğŸ”— å®é™…ä»£ç å®ç°

### åŸºç¡€é…ç½®æ–‡ä»¶
```typescript
// app/agent/config/tools.config.ts
import { ChatOpenAI } from '@langchain/openai';

export const model = new ChatOpenAI({
  model: process.env.OPENAI_MODEL_NAME || "qwen-plus",
  temperature: 0.7,
  maxTokens: 2000,
  streaming: true,  // å¯ç”¨æµå¼å“åº”
});

export async function callAI(messages: any[]) {
  const response = await model.invoke(messages);
  return response;
}
```

---

## ğŸ”— APIè°ƒç”¨å®ç°

```typescript
// app/api/chat/route.ts
export async function POST(request: NextRequest) {
  const { message } = await request.json();
  
  try {
    // åˆ›å»ºç”¨æˆ·æ¶ˆæ¯
    const userMessage = new HumanMessage(message);
    
    // è°ƒç”¨AIæ¨¡å‹
    const response = await model.invoke([userMessage]);
    
    return NextResponse.json({
      success: true,
      data: { content: response.content, role: 'assistant' }
    });
  } catch (error) {
    return NextResponse.json({
      success: false,
      error: 'AIæœåŠ¡æš‚æ—¶ä¸å¯ç”¨'
    }, { status: 500 });
  }
}
```

---

## ğŸŒŸ å‚æ•°è°ƒä¼˜å®è·µ

### Temperatureå‚æ•°æ•ˆæœ
- **0.0-0.3**: æ›´å‡†ç¡®ã€ä¸€è‡´çš„å›ç­”
- **0.4-0.7**: å¹³è¡¡åˆ›é€ æ€§å’Œå‡†ç¡®æ€§ â­
- **0.8-1.0**: æ›´æœ‰åˆ›æ„ä½†å¯èƒ½ä¸å¤ªå‡†ç¡®
- **1.0+**: éå¸¸åˆ›æ„ä½†å¯èƒ½åç¦»ä¸»é¢˜

### maxTokensæ§åˆ¶
```typescript
maxTokens: 2000,  // é€‚åˆèŠå¤©åº”ç”¨çš„é•¿åº¦
```

åˆç†çš„å‚æ•°è®¾ç½®æ˜¯ä¼˜è´¨AIä½“éªŒçš„å…³é”®ï¼

---

## ğŸ”§ æœ€ä½³å®è·µå»ºè®®

### å¼€å‘æŠ€å·§
- **ç¯å¢ƒå˜é‡ç®¡ç†** - å®‰å…¨å­˜å‚¨APIå¯†é’¥
- **é”™è¯¯å¤„ç†** - æ·»åŠ é€‚å½“çš„try-catch
- **å‚æ•°æµ‹è¯•** - å°è¯•ä¸åŒå‚æ•°çœ‹æ•ˆæœ
- **æˆæœ¬æ§åˆ¶** - ç›‘æ§APIè°ƒç”¨é¢‘ç‡å’Œæˆæœ¬

### å¸¸è§é—®é¢˜è§£å†³
- **APIå¯†é’¥é”™è¯¯** â†’ æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
- **æ¨¡å‹è°ƒç”¨å¤±è´¥** â†’ ç¡®è®¤ç½‘ç»œå’ŒAPIé…é¢
- **å“åº”æ ¼å¼å¼‚å¸¸** â†’ æ£€æŸ¥æ¶ˆæ¯æ ¼å¼

---

## ğŸ“‹ æ€»ç»“è¦ç‚¹

- **APIé…ç½®** - æ­£ç¡®é…ç½®å¯†é’¥å’Œæ¨¡å‹å‚æ•°æ˜¯åŸºç¡€
- **æ¨¡å‹é€‰æ‹©** - qwen-plusåœ¨ä¸­æ–‡åœºæ™¯ä¸‹è¡¨ç°ä¼˜å¼‚
- **å‚æ•°è°ƒä¼˜** - temperatureæ§åˆ¶åˆ›é€ æ€§ï¼ŒmaxTokensæ§åˆ¶é•¿åº¦
- **æ¶ˆæ¯æ ¼å¼** - ä½¿ç”¨LangChainçš„æ ‡å‡†æ¶ˆæ¯ç±»å‹
- **æœ€ä½³å®è·µ** - å»ºç«‹å¥å£®çš„APIè°ƒç”¨æœºåˆ¶

OpenAI APIæ˜¯AIåº”ç”¨çš„æ ¸å¿ƒå¼•æ“ï¼

---

## ğŸš€ ä¸‹ä¸€æ­¥é¢„å‘Š

æŒæ¡äº†OpenAI APIåŸºç¡€åï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š

**5.2 LangGraphJSæ ¸å¿ƒåº”ç”¨**
- StateGraphçŠ¶æ€å›¾æ„å»º
- èŠ‚ç‚¹å’Œè¾¹çš„è®¾è®¡åŸç†
- æ£€æŸ¥ç‚¹æŒä¹…åŒ–æœºåˆ¶
- å¯æ‰©å±•çš„AIå·¥ä½œæµ

è®©AIåº”ç”¨æ›´åŠ æ™ºèƒ½å’Œå¼ºå¤§ï¼
